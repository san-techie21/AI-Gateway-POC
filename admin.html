<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Gateway | Enterprise Security Layer</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --primary: #2b2e8c;
            --primary-dark: #1e2165;
            --primary-light: #7978ba;
            --secondary: #ec4899;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0a0b1a;
            --dark-light: #141530;
            --dark-lighter: #1e1f42;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --glass-bg: rgba(10, 11, 26, 0.85);
            --glass-border: rgba(43, 46, 140, 0.25);
            --card-bg: rgba(20, 21, 48, 0.7);
            --gradient-1: linear-gradient(135deg, #2b2e8c 0%, #7978ba 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --gradient-hero: linear-gradient(135deg, #0a0b1a 0%, #1e2165 50%, #2b2e8c 100%);
            --shadow-lg: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 40px rgba(43, 46, 140, 0.4);
            --mo-blue: #2b2e8c;
            --mo-purple: #7978ba;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Background */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: var(--dark);
            overflow: hidden;
        }

        .bg-pattern::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 30% 30%, rgba(43, 46, 140, 0.20) 0%, transparent 50%),
                        radial-gradient(circle at 70% 70%, rgba(121, 120, 186, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 50% 50%, rgba(43, 46, 140, 0.12) 0%, transparent 60%);
            animation: bgFloat 20s ease-in-out infinite;
        }

        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-2%, -2%) rotate(5deg); }
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            padding: 24px 16px;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 12px;
            margin-bottom: 32px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-1);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 8px 16px rgba(99, 102, 241, 0.3);
        }

        .logo-text {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, #c7d2fe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-subtitle {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            padding: 0 12px;
            margin-bottom: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .nav-item:hover {
            background: rgba(43, 46, 140, 0.15);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--gradient-1);
            color: white;
            box-shadow: 0 4px 15px rgba(43, 46, 140, 0.5);
        }

        .nav-item i {
            width: 20px;
            font-size: 16px;
        }

        .nav-item span {
            font-size: 14px;
            font-weight: 500;
        }

        .sidebar-footer {
            margin-top: auto;
            padding: 16px;
            background: rgba(43, 46, 140, 0.15);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
        }

        .mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .mode-label {
            font-size: 13px;
            font-weight: 500;
        }

        .toggle-switch {
            position: relative;
            width: 56px;
            height: 28px;
            background: var(--danger);
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.mock {
            background: var(--primary);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.mock::after {
            left: 31px;
        }

        .mode-status {
            text-align: center;
            font-size: 12px;
            padding: 8px;
            border-radius: 8px;
            font-weight: 600;
        }

        .mode-status.block {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .mode-status.mock {
            background: rgba(43, 46, 140, 0.25);
            color: var(--mo-purple);
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 24px;
            min-height: 100vh;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #fff 0%, #c7d2fe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-subtitle {
            font-size: 14px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--gradient-1);
            color: white;
            box-shadow: 0 4px 15px rgba(43, 46, 140, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(43, 46, 140, 0.5);
        }

        .btn-secondary {
            background: var(--card-bg);
            color: var(--text-primary);
            border: 1px solid var(--glass-border);
        }

        .btn-secondary:hover {
            background: var(--dark-lighter);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stat-card.total::before { background: var(--gradient-1); }
        .stat-card.allowed::before { background: var(--gradient-4); }
        .stat-card.blocked::before { background: var(--gradient-2); }
        .stat-card.local::before { background: var(--gradient-3); }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            margin-bottom: 16px;
        }

        .stat-card.total .stat-icon { background: rgba(43, 46, 140, 0.25); color: var(--mo-purple); }
        .stat-card.allowed .stat-icon { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .stat-card.blocked .stat-icon { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .stat-card.local .stat-icon { background: rgba(79, 172, 254, 0.2); color: #4facfe; }

        .stat-value {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 4px;
        }

        .stat-card.total .stat-value { color: var(--mo-purple); }
        .stat-card.allowed .stat-value { color: var(--success); }
        .stat-card.blocked .stat-value { color: var(--danger); }
        .stat-card.local .stat-value { color: #4facfe; }

        .stat-label {
            font-size: 14px;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary-light);
        }

        /* Chat Interface */
        .chat-container {
            height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 16px;
            margin-bottom: 16px;
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            gap: 12px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--gradient-1);
        }

        .message.assistant .message-avatar {
            background: var(--gradient-3);
        }

        .message.system .message-avatar {
            background: var(--gradient-2);
        }

        .message-content {
            max-width: 70%;
            padding: 14px 18px;
            border-radius: 16px;
            font-size: 14px;
            line-height: 1.6;
        }

        .message.user .message-content {
            background: var(--primary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.assistant .message-content {
            background: var(--dark-lighter);
            border-bottom-left-radius: 4px;
        }

        .message.system .message-content {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            border-bottom-left-radius: 4px;
        }

        .message.local .message-content {
            background: rgba(43, 46, 140, 0.25);
            border: 1px solid rgba(43, 46, 140, 0.4);
            color: #c7d2fe;
            border-bottom-left-radius: 4px;
        }

        .message.local .message-avatar {
            background: var(--gradient-1);
        }

        .chat-input-container {
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 16px 20px;
            background: var(--dark-lighter);
            border: 1px solid var(--glass-border);
            border-radius: 14px;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            border-color: var(--mo-blue);
            box-shadow: 0 0 0 3px rgba(43, 46, 140, 0.2);
        }

        .chat-input::placeholder {
            color: var(--text-muted);
        }

        /* Scan Tester */
        .scan-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .scan-input {
            width: 100%;
            height: 250px;
            padding: 16px;
            background: var(--dark-lighter);
            border: 1px solid var(--glass-border);
            border-radius: 14px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: 'Monaco', 'Consolas', monospace;
            resize: none;
            outline: none;
        }

        .scan-input:focus {
            border-color: var(--primary);
        }

        .scan-result {
            padding: 16px;
            background: var(--dark-lighter);
            border-radius: 14px;
            height: 250px;
            overflow-y: auto;
        }

        .detection-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .severity-badge {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .severity-badge.critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .severity-badge.high {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .severity-badge.medium {
            background: rgba(43, 46, 140, 0.25);
            color: var(--mo-purple);
        }

        .severity-badge.low {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        /* Logs Table */
        .logs-table {
            width: 100%;
            border-collapse: collapse;
        }

        .logs-table th {
            text-align: left;
            padding: 14px 16px;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid var(--glass-border);
        }

        .logs-table td {
            padding: 14px 16px;
            font-size: 14px;
            border-bottom: 1px solid var(--glass-border);
        }

        .logs-table tr:hover {
            background: rgba(43, 46, 140, 0.08);
        }

        .status-pill {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pill.allowed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .status-pill.blocked {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .status-pill.local {
            background: rgba(43, 46, 140, 0.25);
            color: var(--mo-purple);
        }

        /* Settings */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }

        .setting-group {
            background: rgba(0,0,0,0.2);
            border-radius: 16px;
            padding: 20px;
        }

        .setting-group h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .setting-group h3 i {
            color: var(--primary-light);
        }

        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .setting-row:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .setting-input {
            padding: 8px 14px;
            background: var(--dark-lighter);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            width: 200px;
            outline: none;
        }

        .setting-input:focus {
            border-color: var(--mo-blue);
        }

        /* Patterns */
        .patterns-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .pattern-card {
            background: rgba(0,0,0,0.2);
            border-radius: 14px;
            padding: 16px;
            transition: all 0.3s ease;
        }

        .pattern-card:hover {
            background: rgba(43, 46, 140, 0.15);
            transform: translateY(-2px);
        }

        .pattern-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .pattern-desc {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .pattern-regex {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 11px;
            color: var(--mo-purple);
            background: rgba(43, 46, 140, 0.15);
            padding: 6px 10px;
            border-radius: 6px;
            word-break: break-all;
        }

        /* Page Sections */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Activity Feed */
        .activity-feed {
            max-height: 400px;
            overflow-y: auto;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 14px;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .activity-item:hover {
            background: rgba(43, 46, 140, 0.12);
        }

        .activity-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .activity-icon.allowed { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .activity-icon.blocked { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .activity-icon.local { background: rgba(43, 46, 140, 0.25); color: var(--mo-purple); }

        .activity-text {
            flex: 1;
        }

        .activity-title {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 2px;
        }

        .activity-time {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-lighter);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--dark-lighter);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .patterns-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 1024px) {
            .sidebar {
                width: 80px;
                padding: 16px 8px;
            }
            .logo-text, .logo-subtitle, .nav-label, .nav-item span, .sidebar-footer {
                display: none;
            }
            .logo {
                justify-content: center;
            }
            .nav-item {
                justify-content: center;
                padding: 14px;
            }
            .main-content {
                margin-left: 80px;
            }
            .scan-container {
                grid-template-columns: 1fr;
            }
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--glass-border);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            color: var(--dark-lighter);
        }

        .empty-state p {
            font-size: 14px;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1000;
        }

        .toast {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 16px 20px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .toast.success { border-left: 4px solid var(--success); }
        .toast.error { border-left: 4px solid var(--danger); }
        .toast.info { border-left: 4px solid var(--primary); }

        /* Quick Action Cards */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .quick-action {
            background: var(--card-bg);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-action:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
            border-color: var(--mo-blue);
        }

        .quick-action i {
            font-size: 28px;
            margin-bottom: 12px;
            color: var(--primary-light);
        }

        .quick-action span {
            font-size: 14px;
            font-weight: 500;
        }

        /* Hero Section for Dashboard */
        .hero-banner {
            background: var(--gradient-hero);
            border-radius: 24px;
            padding: 32px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }

        .hero-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 60%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: heroGlow 10s ease-in-out infinite;
        }

        @keyframes heroGlow {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-10%, 10%); }
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .hero-subtitle {
            font-size: 16px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 20px;
        }

        .hero-stats {
            display: flex;
            gap: 40px;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-value {
            font-size: 28px;
            font-weight: 700;
        }

        .hero-stat-label {
            font-size: 12px;
            color: rgba(255,255,255,0.6);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Company Badge */
        .company-badge {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255,255,255,0.1);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 11px;
            color: rgba(255,255,255,0.6);
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>

    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-shield-halved"></i>
            </div>
            <div>
                <div class="logo-text">AI Gateway</div>
                <div class="logo-subtitle">Security Layer</div>
            </div>
        </div>

        <nav class="nav-section">
            <div class="nav-label">Main</div>
            <div class="nav-item active" data-page="dashboard">
                <i class="fas fa-chart-pie"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" data-page="chat">
                <i class="fas fa-comments"></i>
                <span>Test Chat</span>
            </div>
            <div class="nav-item" data-page="scan">
                <i class="fas fa-search"></i>
                <span>Scan Tester</span>
            </div>
        </nav>

        <nav class="nav-section">
            <div class="nav-label">Monitor</div>
            <div class="nav-item" data-page="logs">
                <i class="fas fa-list"></i>
                <span>Request Logs</span>
            </div>
            <div class="nav-item" data-page="patterns">
                <i class="fas fa-fingerprint"></i>
                <span>Detection Patterns</span>
            </div>
        </nav>

        <nav class="nav-section">
            <div class="nav-label">Configure</div>
            <div class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </nav>

        <div class="sidebar-footer">
            <div class="mode-toggle">
                <span class="mode-label">Sensitive Data</span>
                <div class="toggle-switch mock" id="modeToggle" onclick="toggleMode()"></div>
            </div>
            <div class="mode-status mock" id="modeStatus">
                <i class="fas fa-robot"></i> MOCK MODE
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Page -->
        <section class="page-section active" id="page-dashboard">
            <div class="header">
                <div>
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle">Real-time monitoring of AI gateway activity</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="refreshStats()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
            </div>

            <div class="hero-banner">
                <div class="hero-content">
                    <h2 class="hero-title">Enterprise AI Security</h2>
                    <p class="hero-subtitle">Protecting sensitive data from external AI exposure</p>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <div class="hero-stat-value" id="heroTotal">0</div>
                            <div class="hero-stat-label">Total Scanned</div>
                        </div>
                        <div class="hero-stat">
                            <div class="hero-stat-value" id="heroProtected">0</div>
                            <div class="hero-stat-label">Protected</div>
                        </div>
                        <div class="hero-stat">
                            <div class="hero-stat-value" id="heroDetections">0</div>
                            <div class="hero-stat-label">Detections</div>
                        </div>
                    </div>
                </div>
                <div class="company-badge">Motilal Oswal Financial Services</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card total">
                    <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="stat-value" id="statTotal">0</div>
                    <div class="stat-label">Total Requests</div>
                </div>
                <div class="stat-card allowed">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-value" id="statAllowed">0</div>
                    <div class="stat-label">Allowed to External</div>
                </div>
                <div class="stat-card blocked">
                    <div class="stat-icon"><i class="fas fa-ban"></i></div>
                    <div class="stat-value" id="statBlocked">0</div>
                    <div class="stat-label">Blocked</div>
                </div>
                <div class="stat-card local">
                    <div class="stat-icon"><i class="fas fa-server"></i></div>
                    <div class="stat-value" id="statLocal">0</div>
                    <div class="stat-label">Routed to Local LLM</div>
                </div>
            </div>

            <div class="quick-actions">
                <div class="quick-action" onclick="showPage('chat')">
                    <i class="fas fa-comment-dots"></i>
                    <span>Test Chat</span>
                </div>
                <div class="quick-action" onclick="showPage('scan')">
                    <i class="fas fa-microscope"></i>
                    <span>Scan Content</span>
                </div>
                <div class="quick-action" onclick="showPage('logs')">
                    <i class="fas fa-history"></i>
                    <span>View Logs</span>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-bolt"></i> Recent Activity</h2>
                    <button class="btn btn-secondary" onclick="loadRecentActivity()">
                        <i class="fas fa-refresh"></i>
                    </button>
                </div>
                <div class="activity-feed" id="activityFeed">
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <p>No recent activity</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chat Page -->
        <section class="page-section" id="page-chat">
            <div class="header">
                <div>
                    <h1 class="page-title">Test Chat</h1>
                    <p class="page-subtitle">Test the AI gateway with sample queries</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="clearChat()">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message assistant">
                            <div class="message-avatar"><i class="fas fa-robot"></i></div>
                            <div class="message-content">
                                Welcome to AI Gateway! I'll scan your messages for sensitive data before sending to external AI. Try sending something with an Aadhaar number or API key to see it in action.
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="chatInput"
                               placeholder="Type a message... (Try: My Aadhaar is 2345 6789 0123)"
                               onkeypress="if(event.key==='Enter')sendChat()">
                        <button class="btn btn-primary" onclick="sendChat()">
                            <i class="fas fa-paper-plane"></i> Send
                        </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-lightbulb"></i> Quick Test Examples</h2>
                </div>
                <div class="quick-actions">
                    <div class="quick-action" onclick="setTestInput('My Aadhaar number is 2345 6789 0123')">
                        <i class="fas fa-id-card"></i>
                        <span>Aadhaar Number</span>
                    </div>
                    <div class="quick-action" onclick="setTestInput('Process PAN ABCDE1234F for tax')">
                        <i class="fas fa-file-invoice"></i>
                        <span>PAN Card</span>
                    </div>
                    <div class="quick-action" onclick="setTestInput('api_key = \"sk-abc123xyz456789012345678901234567890\"')">
                        <i class="fas fa-key"></i>
                        <span>API Key</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Scan Page -->
        <section class="page-section" id="page-scan">
            <div class="header">
                <div>
                    <h1 class="page-title">Scan Tester</h1>
                    <p class="page-subtitle">Test content for sensitive data without making API calls</p>
                </div>
            </div>

            <div class="card">
                <div class="scan-container">
                    <div>
                        <h3 style="margin-bottom: 12px; font-size: 14px; color: var(--text-muted);">
                            <i class="fas fa-edit"></i> Input Content
                        </h3>
                        <textarea class="scan-input" id="scanInput"
                                  placeholder="Paste content here to scan for sensitive data..."></textarea>
                        <button class="btn btn-primary" style="margin-top: 12px; width: 100%;" onclick="runScan()">
                            <i class="fas fa-search"></i> Scan Content
                        </button>
                    </div>
                    <div>
                        <h3 style="margin-bottom: 12px; font-size: 14px; color: var(--text-muted);">
                            <i class="fas fa-shield-alt"></i> Scan Results
                        </h3>
                        <div class="scan-result" id="scanResult">
                            <div class="empty-state">
                                <i class="fas fa-shield-alt"></i>
                                <p>Enter content and click Scan</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Logs Page -->
        <section class="page-section" id="page-logs">
            <div class="header">
                <div>
                    <h1 class="page-title">Request Logs</h1>
                    <p class="page-subtitle">View all processed requests and their status</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="loadLogs()">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                    <button class="btn btn-danger" onclick="clearLogs()">
                        <i class="fas fa-trash"></i> Clear All
                    </button>
                </div>
            </div>

            <div class="card">
                <table class="logs-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>User</th>
                            <th>Status</th>
                            <th>Provider</th>
                            <th>Detections</th>
                            <th>Content Preview</th>
                        </tr>
                    </thead>
                    <tbody id="logsTableBody">
                        <tr>
                            <td colspan="6">
                                <div class="empty-state">
                                    <i class="fas fa-inbox"></i>
                                    <p>No logs yet</p>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Patterns Page -->
        <section class="page-section" id="page-patterns">
            <div class="header">
                <div>
                    <h1 class="page-title">Detection Patterns</h1>
                    <p class="page-subtitle">All patterns used for sensitive data detection</p>
                </div>
            </div>

            <div class="card">
                <div class="patterns-grid" id="patternsGrid">
                    <!-- Patterns will be loaded here -->
                </div>
            </div>
        </section>

        <!-- Settings Page -->
        <section class="page-section" id="page-settings">
            <div class="header">
                <div>
                    <h1 class="page-title">Settings</h1>
                    <p class="page-subtitle">Configure API keys, limits, and blocked keywords</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="saveSettings()">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </div>

            <div class="settings-grid">
                <div class="card">
                    <div class="setting-group">
                        <h3><i class="fas fa-key"></i> API Configuration</h3>
                        <div class="setting-row">
                            <span class="setting-label">Active Provider</span>
                            <select class="setting-input" id="settingProvider">
                                <optgroup label="Major LLMs">
                                    <option value="openai">OpenAI (GPT-4o, o1)</option>
                                    <option value="claude">Anthropic Claude</option>
                                    <option value="gemini">Google Gemini</option>
                                    <option value="deepseek">DeepSeek</option>
                                    <option value="mistral">Mistral AI</option>
                                    <option value="grok">xAI Grok</option>
                                    <option value="cohere">Cohere</option>
                                    <option value="ai21">AI21 Labs</option>
                                </optgroup>
                                <optgroup label="Fast Inference">
                                    <option value="groq">Groq (Ultra-Fast)</option>
                                    <option value="cerebras">Cerebras (Ultra-Fast)</option>
                                    <option value="lepton">Lepton AI</option>
                                    <option value="sambanova">SambaNova</option>
                                    <option value="fireworks">Fireworks AI</option>
                                    <option value="together">Together AI</option>
                                    <option value="deepinfra">DeepInfra</option>
                                    <option value="octoai">OctoAI</option>
                                    <option value="novita">Novita AI</option>
                                </optgroup>
                                <optgroup label="Chinese LLMs">
                                    <option value="glm">Zhipu GLM (ChatGLM)</option>
                                    <option value="qwen">Alibaba Qwen</option>
                                    <option value="baichuan">Baichuan AI</option>
                                    <option value="moonshot">Moonshot (Kimi)</option>
                                    <option value="yi">01.AI Yi</option>
                                </optgroup>
                                <optgroup label="Multi-Provider & Enterprise">
                                    <option value="openrouter">OpenRouter (Multi)</option>
                                    <option value="azure_openai">Azure OpenAI</option>
                                    <option value="aws_bedrock">AWS Bedrock</option>
                                    <option value="huggingface">HuggingFace</option>
                                    <option value="replicate">Replicate</option>
                                    <option value="perplexity">Perplexity AI</option>
                                </optgroup>
                                <optgroup label="Local">
                                    <option value="ollama">Ollama (Local)</option>
                                </optgroup>
                            </select>
                        </div>
                        <div class="setting-row">
                            <span class="setting-label">API Key for Selected Provider</span>
                            <input type="password" class="setting-input" id="settingAPIKey" placeholder="Enter API key...">
                        </div>
                        <button class="btn btn-primary" onclick="saveProviderKey()" style="margin-top: 10px;">
                            <i class="fas fa-save"></i> Save API Key
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="setting-group">
                        <h3><i class="fas fa-tachometer-alt"></i> Limits</h3>
                        <div class="setting-row">
                            <span class="setting-label">Max Content Size (MB)</span>
                            <input type="number" class="setting-input" id="settingMaxSize" value="1">
                        </div>
                        <div class="setting-row">
                            <span class="setting-label">Requests/Minute</span>
                            <input type="number" class="setting-input" id="settingRateLimit" value="10">
                        </div>
                    </div>
                </div>

                <div class="card" style="grid-column: span 2;">
                    <div class="setting-group">
                        <h3><i class="fas fa-ban"></i> Blocked Keywords</h3>
                        <p style="font-size: 12px; color: var(--text-muted); margin-bottom: 12px;">
                            One keyword per line. These will trigger blocking/local routing.
                        </p>
                        <textarea class="scan-input" id="settingKeywords" style="height: 150px;"
                                  placeholder="confidential&#10;internal only&#10;UPSI"></textarea>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        const API_URL = '';
        let currentMode = 'mock';

        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                const page = item.dataset.page;
                showPage(page);
            });
        });

        function showPage(page) {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.querySelector(`[data-page="${page}"]`).classList.add('active');

            document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
            document.getElementById(`page-${page}`).classList.add('active');

            if (page === 'logs') loadLogs();
            if (page === 'patterns') loadPatterns();
            if (page === 'settings') loadSettings();
            if (page === 'dashboard') refreshStats();
        }

        // Mode Toggle
        async function toggleMode() {
            currentMode = currentMode === 'mock' ? 'block' : 'mock';
            updateModeUI();

            try {
                await fetch(`${API_URL}/api/config`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ local_llm_mode: currentMode })
                });
                showToast(`Mode changed to ${currentMode.toUpperCase()}`, 'success');
            } catch (e) {
                showToast('Failed to update mode', 'error');
            }
        }

        function updateModeUI() {
            const toggle = document.getElementById('modeToggle');
            const status = document.getElementById('modeStatus');

            if (currentMode === 'mock') {
                toggle.classList.add('mock');
                status.className = 'mode-status mock';
                status.innerHTML = '<i class="fas fa-robot"></i> MOCK MODE';
            } else {
                toggle.classList.remove('mock');
                status.className = 'mode-status block';
                status.innerHTML = '<i class="fas fa-ban"></i> BLOCK MODE';
            }
        }

        // Stats
        async function refreshStats() {
            try {
                const res = await fetch(`${API_URL}/api/logs/stats`);
                const data = await res.json();

                const total = data.total_requests || 0;
                const allowed = data.by_action?.ALLOWED || 0;
                const blocked = data.by_action?.BLOCKED || 0;
                const local = data.by_action?.ROUTED_LOCAL_LLM || 0;

                animateNumber('statTotal', total);
                animateNumber('statAllowed', allowed);
                animateNumber('statBlocked', blocked);
                animateNumber('statLocal', local);

                animateNumber('heroTotal', total);
                animateNumber('heroProtected', blocked + local);
                animateNumber('heroDetections', Object.values(data.detection_types || {}).reduce((a, b) => a + b, 0));

                loadRecentActivity();
            } catch (e) {
                console.error('Failed to load stats', e);
            }
        }

        function animateNumber(id, target) {
            const el = document.getElementById(id);
            const current = parseInt(el.textContent) || 0;
            const diff = target - current;
            const steps = 20;
            const stepValue = diff / steps;
            let step = 0;

            const interval = setInterval(() => {
                step++;
                el.textContent = Math.round(current + stepValue * step);
                if (step >= steps) {
                    el.textContent = target;
                    clearInterval(interval);
                }
            }, 30);
        }

        // Chat
        async function sendChat() {
            const input = document.getElementById('chatInput');
            const content = input.value.trim();
            if (!content) return;

            addMessage('user', content);
            input.value = '';

            try {
                const res = await fetch(`${API_URL}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        messages: [{ role: 'user', content }],
                        user_id: 'dashboard_user'
                    })
                });

                const data = await res.json();

                if (data.status === 'ALLOWED') {
                    addMessage('assistant', data.response || 'Response received');
                } else if (data.status === 'ROUTED_TO_LOCAL_LLM') {
                    addMessage('local', data.response, data.detections);
                } else if (data.status === 'BLOCKED') {
                    addMessage('system', `BLOCKED: ${data.message}\n\nDetected: ${data.detections?.map(d => d.description).join(', ')}`);
                } else {
                    addMessage('system', data.error || data.message || 'Unknown error');
                }

                refreshStats();
            } catch (e) {
                addMessage('system', 'Connection error: ' + e.message);
            }
        }

        function addMessage(type, content, detections) {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `message ${type}`;

            let icon = 'robot';
            if (type === 'user') icon = 'user';
            if (type === 'system') icon = 'exclamation-triangle';
            if (type === 'local') icon = 'server';

            let detectionsHtml = '';
            if (detections && detections.length > 0) {
                detectionsHtml = '<div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.2);">' +
                    '<strong>Detected:</strong> ' + detections.map(d =>
                        `<span class="severity-badge ${d.severity.toLowerCase()}">${d.type}</span>`
                    ).join(' ') + '</div>';
            }

            div.innerHTML = `
                <div class="message-avatar"><i class="fas fa-${icon}"></i></div>
                <div class="message-content">${content.replace(/\n/g, '<br>')}${detectionsHtml}</div>
            `;

            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }

        function clearChat() {
            const container = document.getElementById('chatMessages');
            container.innerHTML = `
                <div class="message assistant">
                    <div class="message-avatar"><i class="fas fa-robot"></i></div>
                    <div class="message-content">Chat cleared. Ready for new tests.</div>
                </div>
            `;
        }

        function setTestInput(text) {
            document.getElementById('chatInput').value = text;
            document.getElementById('chatInput').focus();
        }

        // Scan
        async function runScan() {
            const content = document.getElementById('scanInput').value;
            const resultDiv = document.getElementById('scanResult');

            if (!content.trim()) {
                showToast('Please enter content to scan', 'error');
                return;
            }

            resultDiv.innerHTML = '<div class="loading"></div>';

            try {
                const res = await fetch(`${API_URL}/api/scan`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ content })
                });

                const data = await res.json();
                const scan = data.scan_result;

                if (!scan.is_sensitive) {
                    resultDiv.innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <i class="fas fa-check-circle" style="font-size: 48px; color: var(--success); margin-bottom: 16px;"></i>
                            <p style="font-size: 16px; color: var(--success);">No sensitive data detected</p>
                            <p style="color: var(--text-muted); margin-top: 8px;">Content would be sent to: ${data.would_route_to}</p>
                        </div>
                    `;
                } else {
                    let html = `
                        <div style="padding: 12px; background: rgba(239, 68, 68, 0.1); border-radius: 10px; margin-bottom: 16px;">
                            <i class="fas fa-exclamation-triangle" style="color: var(--danger);"></i>
                            <strong style="color: var(--danger);"> Sensitive Data Detected</strong>
                            <p style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                                Severity: ${scan.severity} | Would route to: ${data.would_route_to}
                            </p>
                        </div>
                    `;

                    scan.detections.forEach(d => {
                        html += `
                            <div class="detection-item">
                                <span class="severity-badge ${d.severity.toLowerCase()}">${d.severity}</span>
                                <div>
                                    <strong>${d.type}</strong>
                                    <p style="font-size: 12px; color: var(--text-muted);">${d.description}</p>
                                    ${d.matched_text ? `<code style="font-size: 11px; color: var(--danger);">${d.matched_text}</code>` : ''}
                                </div>
                            </div>
                        `;
                    });

                    resultDiv.innerHTML = html;
                }
            } catch (e) {
                resultDiv.innerHTML = `<p style="color: var(--danger);">Error: ${e.message}</p>`;
            }
        }

        // Logs
        async function loadLogs() {
            try {
                const res = await fetch(`${API_URL}/api/logs?limit=50`);
                const data = await res.json();

                const tbody = document.getElementById('logsTableBody');

                if (!data.logs || data.logs.length === 0) {
                    tbody.innerHTML = `
                        <tr><td colspan="6">
                            <div class="empty-state">
                                <i class="fas fa-inbox"></i>
                                <p>No logs yet</p>
                            </div>
                        </td></tr>
                    `;
                    return;
                }

                tbody.innerHTML = data.logs.map(log => {
                    let statusClass = 'allowed';
                    if (log.action === 'BLOCKED') statusClass = 'blocked';
                    if (log.action === 'ROUTED_LOCAL_LLM') statusClass = 'local';

                    const time = new Date(log.timestamp).toLocaleString();
                    const preview = (log.content_preview || '').substring(0, 50) + '...';

                    return `
                        <tr>
                            <td>${time}</td>
                            <td>${log.user_id || 'anonymous'}</td>
                            <td><span class="status-pill ${statusClass}">${log.action}</span></td>
                            <td>${log.provider || '-'}</td>
                            <td>${log.detections_count || 0}</td>
                            <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;">${preview}</td>
                        </tr>
                    `;
                }).join('');
            } catch (e) {
                console.error('Failed to load logs', e);
            }
        }

        async function clearLogs() {
            if (!confirm('Are you sure you want to clear all logs?')) return;

            try {
                await fetch(`${API_URL}/api/logs`, { method: 'DELETE' });
                showToast('Logs cleared', 'success');
                loadLogs();
                refreshStats();
            } catch (e) {
                showToast('Failed to clear logs', 'error');
            }
        }

        // Patterns
        async function loadPatterns() {
            try {
                const res = await fetch(`${API_URL}/api/patterns`);
                const data = await res.json();

                const grid = document.getElementById('patternsGrid');
                grid.innerHTML = data.patterns.map(p => {
                    const severityClass = p.severity.toLowerCase();
                    return `
                        <div class="pattern-card">
                            <div class="pattern-name">
                                <span class="severity-badge ${severityClass}">${p.severity}</span>
                                ${p.name}
                            </div>
                            <div class="pattern-desc">${p.description}</div>
                            <div class="pattern-regex">${p.pattern}</div>
                        </div>
                    `;
                }).join('');
            } catch (e) {
                console.error('Failed to load patterns', e);
            }
        }

        // Settings
        async function loadSettings() {
            try {
                const res = await fetch(`${API_URL}/api/config`);
                const config = await res.json();

                document.getElementById('settingProvider').value = config.active_provider || 'openai';
                document.getElementById('settingMaxSize').value = config.file_size_limits?.max_content_size_mb || 1;
                document.getElementById('settingRateLimit').value = config.rate_limiting?.requests_per_minute || 10;
                document.getElementById('settingKeywords').value = (config.blocked_keywords || []).join('\n');

                currentMode = config.local_llm_mode || 'mock';
                updateModeUI();
            } catch (e) {
                console.error('Failed to load settings', e);
            }
        }

        async function saveProviderKey() {
            const provider = document.getElementById('settingProvider').value;
            const apiKey = document.getElementById('settingAPIKey').value;

            if (!apiKey) {
                showToast('Please enter an API key', 'error');
                return;
            }

            try {
                // First set as active provider
                await fetch(`${API_URL}/api/providers/set-active?provider=${provider}`, {
                    method: 'POST'
                });

                // Then update the API key
                await fetch(`${API_URL}/api/providers/update`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        provider: provider,
                        api_key: apiKey,
                        enabled: true
                    })
                });

                showToast(`${provider} configured and set as active provider`, 'success');
                document.getElementById('settingAPIKey').value = '';
            } catch (e) {
                showToast('Failed to save provider configuration', 'error');
            }
        }

        async function saveSettings() {
            const config = {
                active_provider: document.getElementById('settingProvider').value,
                file_size_limits: {
                    max_content_size_mb: parseInt(document.getElementById('settingMaxSize').value)
                },
                rate_limiting: {
                    requests_per_minute: parseInt(document.getElementById('settingRateLimit').value)
                },
                blocked_keywords: document.getElementById('settingKeywords').value.split('\n').filter(k => k.trim())
            };

            try {
                await fetch(`${API_URL}/api/config`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                showToast('Settings saved successfully', 'success');
            } catch (e) {
                showToast('Failed to save settings', 'error');
            }
        }

        // Activity Feed
        async function loadRecentActivity() {
            try {
                const res = await fetch(`${API_URL}/api/logs?limit=10`);
                const data = await res.json();

                const feed = document.getElementById('activityFeed');

                if (!data.logs || data.logs.length === 0) {
                    feed.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-inbox"></i>
                            <p>No recent activity</p>
                        </div>
                    `;
                    return;
                }

                feed.innerHTML = data.logs.map(log => {
                    let iconClass = 'allowed';
                    let icon = 'check-circle';
                    let title = 'Allowed to external API';

                    if (log.action === 'BLOCKED') {
                        iconClass = 'blocked';
                        icon = 'ban';
                        title = 'Blocked - Sensitive data';
                    } else if (log.action === 'ROUTED_LOCAL_LLM') {
                        iconClass = 'local';
                        icon = 'server';
                        title = 'Routed to Local LLM';
                    }

                    const time = new Date(log.timestamp).toLocaleTimeString();

                    return `
                        <div class="activity-item">
                            <div class="activity-icon ${iconClass}"><i class="fas fa-${icon}"></i></div>
                            <div class="activity-text">
                                <div class="activity-title">${title}</div>
                                <div class="activity-time">${time} - ${log.user_id || 'anonymous'}</div>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (e) {
                console.error('Failed to load activity', e);
            }
        }

        // Toast
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            let icon = 'info-circle';
            if (type === 'success') icon = 'check-circle';
            if (type === 'error') icon = 'exclamation-circle';

            toast.innerHTML = `
                <i class="fas fa-${icon}"></i>
                <span>${message}</span>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            refreshStats();
            loadSettings();
        });
    </script>
</body>
</html>
